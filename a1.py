import streamlit as st
import pandas as pd
from datetime import datetime  # è¡¥å……ä»£ç ä¸­ç”¨åˆ°çš„åº“

# ===================== é¡µé¢åŸºç¡€é…ç½® =====================
# è®¾ç½®é¡µé¢æ ‡é¢˜ã€å¸ƒå±€å’Œä¾§è¾¹æ åˆå§‹çŠ¶æ€
st.set_page_config(
    page_title="å¨é¾™-å¹²å‘˜æ•°å­—æ¡£æ¡ˆ",
    layout="wide",
    initial_sidebar_state="collapsed"
)

# ===================== å…¨å±€æ ·å¼è‡ªå®šä¹‰ =====================
# åŠŸèƒ½ï¼šè®¾ç½®é¡µé¢çš„å…¨å±€æ ·å¼ï¼ŒåŒ…æ‹¬èƒŒæ™¯ã€å­—ä½“ã€ç»„ä»¶æ ·å¼ç­‰
# è¯´æ˜ï¼šä½¿ç”¨MarkdownåµŒå…¥CSSï¼Œé€šè¿‡unsafe_allow_html=Trueå¯ç”¨HTML/CSSæ¸²æŸ“
st.markdown("""
<style>
/* 1. å…¨å±€é‡ç½®ï¼šç»Ÿä¸€å­—ä½“å’Œæ–‡å­—é¢œè‰² */
* {
    color: #ffffff !important;
    font-family: 'Consolas', 'Microsoft YaHei', sans-serif !important;
}

/* 2. é¡µé¢èƒŒæ™¯ï¼šè®¾ç½®ä¸ºçº¯é»‘è‰² */
.stApp {
    background-color: #000000 !important;
}

/* 3. æ ‡é¢˜æ ·å¼ï¼šæ·»åŠ åº•éƒ¨è¾¹æ¡†ã€å†…è¾¹è·å’Œé—´è· */
.stTitle {
    border-bottom: 2px solid #40a9ff;
    padding-bottom: 8px;
    margin-bottom: 25px;
    font-weight: bold;
    font-size: 1.5em;
}

/* 4. å°æ ‡é¢˜æ ·å¼ï¼šè®¾ç½®ä¸Šä¸‹é—´è·ã€å­—ä½“ç²—ç»†å’Œå¤§å° */
.stHeader {
    margin-top: 30px;
    margin-bottom: 15px;
    font-weight: bold;
    font-size: 1.2em;
}

/* 5. æˆ˜æœ¯æŠ€èƒ½çŸ©é˜µï¼ˆMetricç»„ä»¶ï¼‰æ ·å¼ï¼šæ·±è‰²èƒŒæ™¯+è“è‰²è¾¹æ¡† */
.stMetric {
    background-color: #111111;
    border: 1px solid #40a9ff;
    border-radius: 6px;
    padding: 15px;
    margin: 5px 0;
}
/* Metricç»„ä»¶çš„å¢é‡æ–‡å­—é¢œè‰²ï¼šæµ…ç»¿è‰² */
.stMetric div[data-testid="stMetricDelta"] {
    color: #90ee90 !important;
}

/* 6. ä»£ç å—ï¼ˆpre+codeï¼‰æ ·å¼ï¼šçº¯é»‘åº•+æµ…è“è¾¹æ¡†+å·¦è¾¹ç•Œçªå‡º */
pre {
    background-color: #000000 !important;
    border: 1px solid #40a9ff !important;
    border-left: 6px solid #40a9ff !important;
    border-radius: 8px !important;
    padding: 20px !important;
    margin: 10px 0 !important;
    overflow-x: auto !important; /* é€‚é…é•¿ä»£ç æ¨ªå‘æ»šåŠ¨ */
}
/* ä»£ç æ–‡å­—æ ·å¼ï¼šçº¯ç™½å­—+ç­‰å®½å­—ä½“+å¢å¤§è¡Œé«˜ */
code {
    color: #ffffff !important;
    font-size: 1.1em !important;
    line-height: 1.8 !important;
    font-family: 'Consolas', 'Monaco', monospace !important;
}

/* 7. è¡¨æ ¼æ ·å¼ï¼šæ·±è‰²èƒŒæ™¯+è“è‰²è¾¹æ¡†ï¼Œå•å…ƒæ ¼å±…ä¸­å¯¹é½ */
.stTable {
    border: 1px solid #40a9ff;
    border-radius: 6px;
    background-color: #111111;
    width: 100%;
}
.stTable th, .stTable td {
    border: 1px solid #40a9ff;
    padding: 10px;
    text-align: center;
    font-size: 1em;
}
/* è¡¨æ ¼è¡¨å¤´æ ·å¼ï¼šæ·±è‰²èƒŒæ™¯+åŠ ç²— */
.stTable th {
    background-color: #1e293b;
    font-weight: bold;
}

/* 8. é“¾æ¥æ ·å¼ï¼šæµ…è“è‰²+ä¸‹åˆ’çº¿ */
a {
    color: #40a9ff !important;
    text-decoration: underline !important;
}

/* 9. è¯´æ˜æ–‡å­—ï¼ˆCaptionï¼‰æ ·å¼ï¼šè®¾ç½®å­—ä½“å¤§å°å’Œä¸‹é—´è· */
.stCaption {
    font-size: 1em;
    margin-bottom: 10px !important;
}
</style>
""", unsafe_allow_html=True)

# ===================== é¡µé¢å¸ƒå±€æ§åˆ¶ =====================
# åŠŸèƒ½ï¼šåˆ›å»ºä¸‰åˆ—å¸ƒå±€ï¼Œä½¿ç”¨ä¸­é—´åˆ—ä½œä¸ºä¸»è¦å†…å®¹åŒºåŸŸï¼Œå®ç°å·¦å³è¾¹è·çš„ç¼©è¿›æ•ˆæœ
main_col = st.columns([1, 8, 1])[1]

# ===================== ä¸»è¦å†…å®¹åŒºåŸŸ =====================
with main_col:
    # 1. é¡µé¢ä¸»æ ‡é¢˜å’Œå‰¯æ ‡é¢˜
    st.title("ä¸‰è§’æ´²å¹²å‘˜ã€Œå¨é¾™ã€æ•°å­—æ¡£æ¡ˆ", anchor="vyron-main")
    st.text("â€”â€”G.T.I.äºšæ´²åˆ†éƒ¨çªå‡»å…µæˆ˜æœ¯æ¡£æ¡ˆ v1.0ï¼ˆ2025å¹´12æœˆæ›´æ–°ï¼‰")

    # 2. åŸºç¡€ä¿¡æ¯æ¨¡å—
    st.header("ä¸€ã€åŸºç¡€ä¿¡æ¯ ğŸ“‹", anchor="basic-info")
    # ä½¿ç”¨Markdownè¡¨æ ¼å±•ç¤ºå¹²å‘˜åŸºç¡€æ¡£æ¡ˆä¿¡æ¯
    st.markdown("""
    | æ¡£æ¡ˆé¡¹          | è¯¦ç»†ä¿¡æ¯                                                                 |
    |-----------------|--------------------------------------------------------------------------|
    | å¹²å‘˜ä»£å·        | å¨é¾™ï¼ˆVyronï¼Œæºè‡ªå¸Œè…Šè¯­â€œè‹±é›„â€ï¼Œè±¡å¾é«˜æœºåŠ¨æˆ˜æœ¯å®šä½ï¼‰                     |
    | çœŸå®å§“å        | ç‹å®‡æ˜Š                                                                   |
    | æ‰€å±é˜µè¥        | G.T.I.ï¼ˆå…¨çƒæˆ˜æœ¯å¹²é¢„ç»„ç»‡ï¼‰äºšæ´²åˆ†éƒ¨                                       |
    | å…µç§ç±»å‹        | çªå‡»å…µï¼ˆä¸“ç²¾è½½å…·ç ´è¢­ä¸å¿«é€Ÿçªè¢­ï¼‰                                         |
    | æ ¸å¿ƒè£…å¤‡        | åŠ¨èƒ½è¾…åŠ©ç³»ç»Ÿã€ç£å¸ç‚¸å¼¹ï¼ˆä»£å·â€œçº¢åŒ…â€ï¼‰ã€QLL32è‚©å°„æ¦´å¼¹å‘å°„å™¨ï¼ˆè™è¹²ç‚®ï¼‰      |
    | æ¡£æ¡ˆç­‰çº§        | æœºå¯†ï¼ˆä»…æˆ˜æœ¯æŒ‡æŒ¥å±‚å¯è§ï¼‰                                                 |
    | æ•°æ®é‡‡é›†æ¥æº    | å¯’æ²™è¡ŒåŠ¨å®æˆ˜è®°å½•ã€æ¨¡æ‹Ÿè®­ç»ƒç³»ç»Ÿã€å¹²å‘˜å¿ƒç†è¯„ä¼°æŠ¥å‘Š                         |
    """)

    # 3. æˆ˜æœ¯æŠ€èƒ½çŸ©é˜µæ¨¡å—
    st.header("äºŒã€æˆ˜æœ¯æŠ€èƒ½çŸ©é˜µ ğŸš€", anchor="skill-matrix")
    # åˆ†ä¸‰åˆ—å±•ç¤ºæŠ€èƒ½æŒ‡æ ‡ï¼Œè®¾ç½®åˆ—é—´è·ä¸ºmedium
    skill_col1, skill_col2, skill_col3 = st.columns(3, gap="medium")
    with skill_col1:
        # åŠ¨èƒ½è¾…åŠ©ç³»ç»ŸæŒ‡æ ‡ï¼šæ•ˆèƒ½å€¼+å¢é‡+è¯´æ˜
        st.metric(
            label="åŠ¨èƒ½è¾…åŠ©ç³»ç»Ÿ",
            value="92% æ•ˆèƒ½",
            delta="+8%ï¼ˆå¯¹æ¯”ä¸Šå­£åº¦ï¼‰",
            help="å–·æ°”å¼å•å…µè£…ç½®ï¼Œæ”¯æŒå¿«é€Ÿä½ç§»ä¸å è½ç¼“å†²"
        )
    with skill_col2:
        # ç£å¸ç‚¸å¼¹æŒ‡æ ‡ï¼šç ´ç”²ç‡+å¢é‡+è¯´æ˜
        st.metric(
            label="ç£å¸ç‚¸å¼¹ï¼ˆè½½å…·ç ´è¢­ï¼‰",
            value="98% ç ´ç”²ç‡",
            delta="+5%ï¼ˆé€‚é…æ–°è£…ç”²ï¼‰",
            help="å¸é™„å«é“è¡¨é¢ï¼Œ2é¢—å¯æ‘§æ¯è½»å‹è½½å…·"
        )
    with skill_col3:
        # è™è¹²ç‚®æŒ‡æ ‡ï¼šéœ‡æ…‘æ•ˆèƒ½+å¢é‡+è¯´æ˜
        st.metric(
            label="è™è¹²ç‚®ï¼ˆåŒºåŸŸå‹åˆ¶ï¼‰",
            value="87% éœ‡æ…‘æ•ˆèƒ½",
            delta="-3%ï¼ˆå¤æ‚åœ°å½¢ä¿®æ­£ï¼‰",
            help="ç»´å’Œé•‡æš´ä¸“ç”¨ï¼Œè¦†ç›–5ç±³åŠå¾„å‹åˆ¶èŒƒå›´"
        )

    # 4. å®æˆ˜ä»»åŠ¡æ—¥å¿—æ¨¡å—
    st.header("ä¸‰ã€å®æˆ˜ä»»åŠ¡æ—¥å¿— ğŸ“…", anchor="mission-log")
    st.text("ä»»åŠ¡è®°å½•æŒ‰å­£åº¦åˆ†ç±»ï¼ŒåŒ…å«æ ¸å¿ƒæˆ˜æœ¯æŒ‡æ ‡ä¸å®ŒæˆçŠ¶æ€")
    # å®šä¹‰ä»»åŠ¡æ—¥å¿—æ•°æ®
    mission_data = {
        "ä»»åŠ¡ç¼–å·": ["TA-20251005", "TA-20251012", "TA-20251101", "TA-20251115"],
        "ä»»åŠ¡åç§°": ["å¯’æ²™è¡ŒåŠ¨-è½½å…·æ”»åš", "åŸåŒºæ¸—é€-äººè´¨è§£æ•‘", "è¾¹å¢ƒç»´å’Œ-åŒºåŸŸå‹åˆ¶", "è®­ç»ƒåœºæ¨¡æ‹Ÿ-æ–°è£…å¤‡æµ‹è¯•"],
        "ä»»åŠ¡çŠ¶æ€": ["âœ… å·²å®Œæˆ", "âœ… å·²å®Œæˆ", "âœ… å·²å®Œæˆ", "ğŸ”„ è¿›è¡Œä¸­"],
        "ä»»åŠ¡éš¾åº¦": ["â˜…â˜…â˜…â˜…â˜†", "â˜…â˜…â˜…â˜…â˜…", "â˜…â˜…â˜…â˜†â˜†", "â˜…â˜…â˜†â˜†â˜†"],
        "å®Œæˆç‡": ["100%", "98%", "100%", "75%"],
        "æ ¸å¿ƒè´¡çŒ®": ["æ‘§æ¯3è¾†æ•Œæ–¹è£…ç”²è½¦", "æˆåŠŸè§£æ•‘6åäººè´¨", "æ§åˆ¶2ä¸ªå…³é”®æ®ç‚¹", "å®Œæˆç£å¸ç‚¸å¼¹æ•ˆèƒ½æµ‹è¯•"]
    }
    # è®¾ç½®ä»»åŠ¡å­£åº¦ä¸ºç´¢å¼•
    mission_index = pd.Series(["ç¬¬1å­£åº¦", "ç¬¬1å­£åº¦", "ç¬¬2å­£åº¦", "ç¬¬2å­£åº¦"], name="ä»»åŠ¡å­£åº¦")
    mission_df = pd.DataFrame(mission_data, index=mission_index)
    # å±•ç¤ºä»»åŠ¡æ—¥å¿—è¡¨æ ¼
    st.table(mission_df)

    # 5. æˆ˜æœ¯æ•°æ®é‡‡é›†ä»£ç æ¨¡å—
    st.header("å››ã€æˆ˜æœ¯æ•°æ®é‡‡é›†ä»£ç  ğŸ’»", anchor="code-snippet")
    st.caption("ä»£ç åŠŸèƒ½ï¼šä»G.T.I.æ¥å£è·å–å¨é¾™å¹²å‘˜å®æ—¶æˆ˜æœ¯æ•°æ®ï¼ˆç®€åŒ–ç‰ˆï¼‰")
    # å®šä¹‰ä»£ç å†…å®¹ï¼šæ¨¡æ‹Ÿè·å–ä»»åŠ¡æ—¥å¿—æ•°æ®çš„å‡½æ•°
    code_content = '''import pandas as pd
from datetime import datetime

def get_vyron_mission_data():
    """
    æ¨¡æ‹Ÿè·å–å¨é¾™å¹²å‘˜ä»»åŠ¡æ—¥å¿—æ•°æ®
    è¿”å›ï¼šç»“æ„åŒ–ä»»åŠ¡æ•°æ®DataFrame
    """
    # 1. å®šä¹‰ä»»åŠ¡æ•°æ®ï¼ˆä¸æ¡£æ¡ˆä¸­ä»»åŠ¡æ—¥å¿—ä¸€è‡´ï¼‰
    mission_data = {
        "ä»»åŠ¡ç¼–å·": ["TA-20251005", "TA-20251012", "TA-2025101", "TA-20251115"],
        "ä»»åŠ¡åç§°": ["å¯’æ²™è¡ŒåŠ¨-è½½å…·æ”»åš", "åŸåŒºæ¸—é€-äººè´¨è§£æ•‘", "è¾¹å¢ƒç»´å’Œ-åŒºåŸŸå‹åˆ¶", "è®­ç»ƒåœºæ¨¡æ‹Ÿ-æ–°è£…å¤‡æµ‹è¯•"],
        "ä»»åŠ¡çŠ¶æ€": ["âœ… å·²å®Œæˆ", "âœ… å·²å®Œæˆ", "âœ… å·²å®Œæˆ", "ğŸ”„ è¿›è¡Œä¸­"],
        "å®Œæˆç‡": ["100%", "98%", "100%", "75%"]
    }
    # 2. æ·»åŠ æ•°æ®é‡‡é›†æ—¶é—´ï¼ˆæ•°æ®é¢„å¤„ç†æ­¥éª¤ï¼‰
    mission_index = pd.Series(["ç¬¬1å­£åº¦", "ç¬¬1å­£åº¦", "ç¬¬2å­£åº¦", "ç¬¬2å­£åº¦"], name="ä»»åŠ¡å­£åº¦")
    df = pd.DataFrame(mission_data, index=mission_index)
    df["é‡‡é›†æ—¶é—´"] = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
    
    return df

# è°ƒç”¨å‡½æ•°ç”Ÿæˆä»»åŠ¡æ—¥å¿—æ•°æ®
if __name__ == "__main__":
    vyron_mission_log = get_vyron_mission_data()
    print("å¨é¾™å¹²å‘˜å®æˆ˜ä»»åŠ¡æ—¥å¿—ï¼š")
    print(vyron_mission_log)
    # ä¿å­˜ä¸ºExcelï¼ˆéœ€å®‰è£…openpyxlï¼špip install openpyxlï¼‰
    # vyron_mission_log.to_excel("å¨é¾™ä»»åŠ¡æ—¥å¿—.xlsx", index=True)'''
    # æ¸²æŸ“åŸç”Ÿä»£ç å—ï¼ˆä½¿ç”¨HTMLçš„preå’Œcodeæ ‡ç­¾ï¼Œä¿ç•™æ ·å¼ï¼‰
    st.markdown(f"<pre><code>{code_content}</code></pre>", unsafe_allow_html=True)

    # 6. æ¡£æ¡ˆå¤‡æ³¨æ¨¡å—
    st.header("äº”ã€æ¡£æ¡ˆå¤‡æ³¨ âš ï¸", anchor="notes")
    st.text("1. ä»»åŠ¡æ—¥å¿—è¡¨æ ¼é‡‡ç”¨é™æ€Tableæ ¼å¼ï¼Œé€‚é…ä¸åŒæµè§ˆå™¨æ¸²æŸ“ï¼Œé¿å…åŠ¨æ€åŠ è½½é—®é¢˜ï¼›")
    st.text("2. æŠ€èƒ½çŸ©é˜µæ•ˆèƒ½å€¼åŸºäº10æ¬¡å®æˆ˜å¹³å‡è®¡ç®—ï¼Œå¤æ‚åœ°å½¢ï¼ˆé›¨æ—/åŸåŒºï¼‰ä¸‹å…è®¸Â±5%æ³¢åŠ¨ï¼›")
